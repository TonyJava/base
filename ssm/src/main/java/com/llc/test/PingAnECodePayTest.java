package com.llc.test;

import org.apache.log4j.Logger;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;

/**
 * 平安E码付 测试
 * @author liqiang
 *
 */
public class PingAnECodePayTest {
	private static Logger log = Logger.getLogger(PingAnECodePayTest.class);
	
	public static String TRADER_OID_PARTNER = "";
	public static String TRADER_MD5_KEY="";
	public static String TRADER_RSA_PRIVATE_KEY="";
	public static String TRADER_RSA_PUBLIC_KEY;
	
	//商户参数名
	public final static String OPEN_id="open_id";
	public final static String OPEN_KEY="open_key";
	
	public final static String OPEN_ID_VALUE="e262f405e0e3e5ebc13efb44f250aca0";
	public final static String OPEN_KEY_VALUE="1b0628cc8dad7d1fe59a84687867da92";
	
	/**
	 * 生产地址
	 */
	public final static String PREX_INTERFACE_DEPLOY="https://api.tlinx.com/mct1";
	
	/**
	 * 测试地址
	 */
	public final static String PREX_INTERFACE_DEBUG="http://openapi.tlinx.cn/mct1";
	
	public static String PREX_INTERFACE="";
	
	static{
		
		//生产
		TRADER_OID_PARTNER = "201511201000605504";
		TRADER_RSA_PRIVATE_KEY = "MIICdgIBADANBgkqhkiG9w0BAQEFAASCAmAwggJcAgEAAoGBAMOHlCL9sIg0BiIfSXOCxZR/uXEjsU0YrcjJqT7gztwODHB3Nex542lVfKGgVib4SJiIV2rX9Rob+s5XJ8zcyBj1d2nyxmKu5PU26u/JYEpXEdRLrLll6hgEqJQBPFWEvCbg/bQovpUp3KQFpj13KL90+owJu6puqWG2WROx4PpbAgMBAAECgYAPAEPZO2Vjzbn6vDPCbPIDppjvmTFtHMuYcABQFqdIMru5lSvJ7MAJwMlDDS4O51WKfktWoyLm0ea4Fe+zw+yF+1e+GUWoTejsBLsHi+4L16/JaGOGVGNgudk4JEydesxoFOQmsZ80CGs3944gSvzk3cK66bhnFhn1PcLY5IlSYQJBAOWb49gjiETIn8+6Y+tFz/4SS8jZCb58xrMtdt0RIkDgHfv6MzpBHcB8z2ZGbxROMazlSsRUYiEyga9wVX3I4LUCQQDaAOx+PPFzNoHrneW8At1xDIMA2DtebhNX5iMsevG3cSunfyVl8Q+Qg9vQJV0YQQCCp9sC13UvEOAKkg11WyjPAkA/kGOIL3YHDL9pQ4Fr3ZzSCoCebq9K48IiUmDInHiuGx1R55cM9n/lDOhhuPgBWBBae/Ox3GZ6KEBMsD2Kn/TNAkEArCmGmrsuQzqMp7Jut2fb0Wd8HbKmUBDGHeiVZo9BTQmG3CRBOJyDGjHH6j1Xo8vRx10gTMIyvRSqmi51inSPaQJAV8c9HOeAoF7CjYG6NeCnnhuaFIa8lq5ok+3+2LulHaUHSmcIxpnvPeCwTUUpLDC8ZR1k6xtxoo6YWCHtOd70Kg==";
		TRADER_RSA_PUBLIC_KEY = "MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCSS/DiwdCf/aZsxxcacDnooGph3d2JOj5GXWi+q3gznZauZjkNP8SKl3J2liP0O6rU/Y/29+IUe+GTMhMOFJuZm1htAtKiu5ekW0GlBMWxf4FPkYlQkPE0FtaoMP3gYfh+OwI+fIRrpW3ySn3mScnc6Z700nU/VYrRkfcSCbSnRwIDAQAB";
		
		//MyUtils.getDateByFormat(new Date(),"yyyyMMddHHmmss")
		
		PREX_INTERFACE=PREX_INTERFACE_DEPLOY;
		
	}
	
	/**
	 * @param args
	 */
	public static void main(String[] args) {
		
		
			//解析结果
			analysisContentPaylist();
		
	
	}
	
	
	
	/**
	 * 解析收到的报文
	 */
	public static void analysisContentPaylist(){
		
		//TODO json转对象
		
		//解析
		String resultJson="{'errcode': 0,'msg': 'ok','data': [{'pmt_name': '微信','pmt_type': '2,3','pmt_icon': '/Public/images/Weixin.jpg','pmt_tag': 'Weixin'}]}";
		
		resultJson="{'data':'BA0CAFCE3B1EFF943D6169A45B64BDE7A6BDD7E60B1E1F44CCBCD9A01628FAB1D39667EDED4C3BFE1CD6D45D365431A4E496D27C52920D2EE88A34BA0AE5856ECBE5A4C8661B79573276C3853AEAACCDC9AF00F35A84AA636BD42CC770E1DE123B9ECB97C85AA49C035FBDB2497CFF4DB23915E061E208FD83584320862DC38002B48250683874360738992E530E41362ED00D04CCB6C71D825307B3E804A28D874563890C3E3F32357AF67FB96C89D610B4EF5F0AD58E5EF849E74FD93DF2FCD2CE0088264F9D6EC72E82F0C408BFA4FFD5928672A3E21A0F2E66C5A8F29BB469E0FDE8E1F8E5E6E9615D90958DF5DCF4938FAF172DF1D6767D5F93080B424E30AA26D199A1FE2842228AD4B787A9AFA377EF0EC18EDDC96E629D368E72710DDFA591814900BB5AF9DB2FBF3099359570EBF2FD5C4C31E81B817E4488A77B5D3ED7F13B5E37253DA9A864F52219292561C09A949563142DF0DDF3FAC79129A750631D5B4E1376E805B5112431DE41BBF5603B69CEA017AE178AEE82602C4621CC920216C92ACC20D8E25E904DA84C94669300987E63849430DD79A58EDF64414A0154CD6F479672828DB94DAC95F1EE2C51742B1540B359A8BA3E12AC7B587243DFB71D64DDA627137B9BD3F9F99EB23308655AE395AE0A2E933F37B324D11F38C1CFB5A1B42D87409CF0496A846A3BEF469FF3255711BD43945FA4556C97780A4462E326A580047D5AD20AC38A4471BDD9DC8CB7E54E7AF55147A58C6410B0474D55A19231EFE094BA79257D90450AF8B3EA994C836DFBEA0CDD64445683E447E01F0101EDB190934B8C2C6C8026901055CD80813145A34AB99C5ECF682A0F258583F1ADF683E20CB721E579BF8DF5B9BE330FB01430CF2DDDAF8BD0003C18552E6B9EC363CCA6E534F36CE8293F8D2C35002BEEE1F760C23DC61DD80C9F5815B8AB7672A32F886978D2B51BADCFF2A2DF4FB71A0FCA5B370C2F39EB8B78442ABCE57EF94CA8301911BF434A413450EBED765D46B1801CE65E771A2B1D979055704C1763C7D0E1AE9E223EAB2EA140','errcode':0,'msg':'ok','timestamp':1490085724,'sign':'731dfb02896f38b10e291bd43089c392'}";
		
		
		//pmt_name  32 收单机构名称
		//pmt_type  20 支付类型（0 现金，1 刷卡（拍卡），2 主扫，3 被扫）,可能含有多个条件组合。多个以小写逗号分开
		//pmt_icon  30 图标
		//pmt_tag   20 支付标签
		
		JSONObject json=JSON.parseObject(resultJson);
		
		String errorcode=String.valueOf(json.get("errcode"));
		String msg=json.getString("msg");
		
		log.info("errorcode:"+errorcode+",msg:"+msg);
		
		//拿到data后先进行解密
		String data=json.getString("data");
		
		System.out.println("data:"+data);
		
		data="BA0CAFCE3B1EFF943D6169A45B64BDE7A6BDD7E60B1E1F44CCBCD9A01628FAB1D39667EDED4C3BFE1CD6D45D365431A4E496D27C52920D2EE88A34BA0AE5856ECBE5A4C8661B79573276C3853AEAACCDC9AF00F35A84AA636BD42CC770E1DE123B9ECB97C85AA49C035FBDB2497CFF4DB23915E061E208FD83584320862DC38002B48250683874360738992E530E41362ED00D04CCB6C71D825307B3E804A28D874563890C3E3F32357AF67FB96C89D610B4EF5F0AD58E5EF849E74FD93DF2FCD2CE0088264F9D6EC72E82F0C408BFA4FFD5928672A3E21A0F2E66C5A8F29BB469E0FDE8E1F8E5E6E9615D90958DF5DCF4938FAF172DF1D6767D5F93080B424E30AA26D199A1FE2842228AD4B787A9AFA377EF0EC18EDDC96E629D368E72710DDFA591814900BB5AF9DB2FBF3099359570EBF2FD5C4C31E81B817E4488A77B5D3ED7F13B5E37253DA9A864F52219292561C09A949563142DF0DDF3FAC79129A750631D5B4E1376E805B5112431DE41BBF5603B69CEA017AE178AEE82602C4621CC920216C92ACC20D8E25E904DA84C94669300987E63849430DD79A58EDF64414A0154CD6F479672828DB94DAC95F1EE2C51742B1540B359A8BA3E12AC7B587243DFB71D64DDA627137B9BD3F9F99EB23308655AE395AE0A2E933F37B324D11F38C1CFB5A1B42D87409CF0496A846A3BEF469FF3255711BD43945FA4556C97780A4462E326A580047D5AD20AC38A4471BDD9DC8CB7E54E7AF55147A58C6410B0474D55A19231EFE094BA79257D90450AF8B3EA994C836DFBEA0CDD64445683E447E01F0101EDB190934B8C2C6C8026901055CD80813145A34AB99C5ECF682A0F258583F1ADF683E20CB721E579BF8DF5B9BE330FB01430CF2DDDAF8BD0003C18552E6B9EC363CCA6E534F36CE8293F8D2C35002BEEE1F760C23DC61DD80C9F5815B8AB7672A32F886978D2B51BADCFF2A2DF4FB71A0FCA5B370C2F39EB8B78442ABCE57EF94CA8301911BF434A413450EBED765D46B1801CE65E771A2B1D979055704C1763C7D0E1AE9E223EAB2EA140";
		
		//data="BE493732102064876B89862824DF8B0B779";
		
		String decrptData="";
		try {
		   // decrptData=AESUtil.decrypt(data,OPEN_KEY_VALUE);
		} catch (Exception e) {
			e.printStackTrace();
		}
		
		System.out.println("decrptData:"+decrptData);
		
//		JSONArray array=json.getJSONArray("data");
//		for(int index=0;index<array.length();index++){
//			JSONObject item=array.getJSONObject(index);
//			log.info("收单机构名称:"+item.getString("pmt_name"));
//			log.info("支付类型:"+item.getString("pmt_type"));
//			log.info("图标:"+item.getString("pmt_icon"));
//			log.info("支付标签:"+item.getString("pmt_tag"));
//		}
		
	}
	
	
	
}
